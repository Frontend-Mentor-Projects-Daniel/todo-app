{"version":3,"sources":["node_modules/browser-pack/_prelude.js","src/ts/main.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","// WHEN USER CLICKS ON COMPLETED BUTTON, ADD GRADIENT\n// get the id of the todo\n// find the specific todo\n// change the completed property to true\n// Save the state\n\n// WHEN USER CLICKS ON COMPLETED BUTTON, ADD LINE THROUGH\n// get the id of the todo\n// find the specific todo\n// change the p tag to a del tag\n// -> This will probably require some updating of the renderListItem function\n// -> May also be better to create a function to render a single todo rather than re-render all of them\n\n// ------------------------------------------------------------------------------\n//                                 DOM NODES\n\n//-------------------------------------------------------------------------------\nconst todos = document.querySelectorAll(\n  '.todo-list-item'\n) as NodeListOf<HTMLLIElement>;\nconst form = document.querySelector('.create-bar-form') as HTMLFormElement;\nconst input = document.querySelector('.create-bar') as HTMLInputElement;\nconst ul = document.querySelector('.list') as HTMLUListElement;\nconst template = document.querySelector(\n  '#example-list-item'\n) as HTMLTemplateElement;\n\n// ------------------------------------------------------------------------------\n//                                 TYPES\n//-------------------------------------------------------------------------------\ntype Todo = {\n  id: string;\n  value: string;\n  completed: boolean;\n};\n\ntype validButton = 'delete-btn' | 'complete-btn' | 'not-a-button';\n\ntype allowedElements = 'p' | 'ins' | 'del';\n\n// ------------------------------------------------------------------------------\n//                                 MODEL\n//-------------------------------------------------------------------------------\ntype Model = {\n  AllTodos: Todo[];\n};\n\n// ------------------------------------------------------------------------------\n//                               GLOBAL STATE\n//-------------------------------------------------------------------------------\nconst init: Model = {\n  AllTodos: [],\n};\nObject.freeze(init);\n\n// ------------------------------------------------------------------------------\n//                             UPDATE FUNCTION\n//-------------------------------------------------------------------------------\ntype Msg = 'AddTodo' | 'RemoveTodo' | 'UpdateTodo' | 'CompleteTodo';\n\nfunction update(msg: Msg, model: Model, value: Todo): void {\n  switch (msg) {\n    case 'AddTodo':\n      model.AllTodos.push(value);\n      break;\n\n    case 'RemoveTodo':\n      model.AllTodos.forEach((todo) => {\n        if (todo.id === value.id) {\n          const index = model.AllTodos.indexOf(todo);\n          model.AllTodos.splice(index, 1);\n        }\n      });\n      break;\n\n    case 'UpdateTodo':\n      model.AllTodos.forEach((todo) => {\n        if (todo.id === value.id) {\n          const index = model.AllTodos.indexOf(todo);\n          model.AllTodos[index].value = value.value;\n        }\n      });\n      break;\n\n    case 'CompleteTodo':\n      model.AllTodos.forEach((todo) => {\n        if (todo.id === value.id) {\n          const index = model.AllTodos.indexOf(todo);\n          model.AllTodos[index].completed = !value.completed;\n        }\n      });\n      break;\n  }\n}\n\n// ------------------------------------------------------------------------------\n//                                   SCRIPTS\n//-------------------------------------------------------------------------------\n\n// GET TODOS FROM LOCAL STORAGE AND DISPLAY THEM\n((model: Model) => {\n  const getStoredTodos: string = getItemsFromLocalStorage('todos');\n  const parseStoredTodos: Todo[] = parseTodos(getStoredTodos);\n\n  // if there're no previous todo's, create example todo\n  if (parseStoredTodos.length === 0) {\n    const newTodo = renderListItemNode(template);\n    update('AddTodo', model, newTodo);\n  } else {\n    for (const todo of parseStoredTodos) {\n      update('AddTodo', model, todo);\n    }\n  }\n\n  renderTodos(model.AllTodos);\n\n  // add event listener to initial todo so that it can be set to complete as well\n  const allTodos = document.querySelectorAll('.complete-btn');\n  allTodos.forEach((todo) => {\n    todo.addEventListener('click', (e) => {\n      // handleCompletedClick(e, model);\n      saveToLocalStorage(model.AllTodos);\n    });\n  });\n})(init);\n\n// CREATE NEW TODOS\n((model: Model) => {\n  form.addEventListener('submit', (e) => {\n    e.preventDefault();\n    const getUserInput = input.value.trim();\n    const isUserInputEmpty = CheckIfEmptyString(getUserInput);\n    const createNewTodo = createTodoObject(getUserInput);\n\n    if (!isUserInputEmpty) {\n      update('AddTodo', model, createNewTodo);\n      saveToLocalStorage(model.AllTodos);\n    }\n\n    renderTodos(model.AllTodos);\n  });\n})(init);\n\n// DELETE TODOS\n((model: Model) => {\n  ul.addEventListener('click', (e) => {\n    const xImage = e.target as HTMLImageElement;\n    const button = xImage.parentElement as HTMLButtonElement;\n\n    const li = button.parentElement as HTMLLIElement;\n\n    const todoId = li.dataset.id as string;\n    const isDeleteOrUpdateBtn = checkTypeOfButton(button);\n\n    if (isDeleteOrUpdateBtn === 'delete-btn') {\n      const todoThatShouldBeDeleted = findTodo(todoId, model);\n      deleteTodo(todoThatShouldBeDeleted.id, model, li);\n      update('RemoveTodo', model, todoThatShouldBeDeleted);\n      saveToLocalStorage(model.AllTodos);\n    }\n  });\n})(init);\n\n// UPDATE TODOS\n((model: Model) => {\n  ul.addEventListener('focusout', (e) => {\n    const target = e.target;\n\n    if (target instanceof HTMLParagraphElement) {\n      const text = target.textContent !== null ? target.textContent : '';\n      const listItem = target.parentElement as HTMLLIElement;\n      const listItemID = listItem.dataset.id;\n\n      if (listItemID !== undefined) {\n        const updatedTodo: Todo = {\n          id: listItemID,\n          value: text,\n          completed: false,\n        };\n\n        const newChild = document.createElement('del');\n        newChild.className = 'list-item-text';\n        newChild.textContent = text;\n        const oldChild = target;\n        const parent = listItem;\n\n        const replacementInfo = { parent, newChild, oldChild };\n        // console.log(replacementInfo);\n\n        update('UpdateTodo', model, updatedTodo);\n        // handleCompletedClick(e, model, replacementInfo);\n        saveToLocalStorage(model.AllTodos);\n      } else {\n        throw new Error(\"This list item doesn't have an ID\");\n      }\n    }\n  });\n})(init);\n\n// COMPLETE TODO\n((model: Model) => {\n  // Options for the observer (which mutations to observe)\n  const config = { childList: true };\n\n  // Callback function to execute when mutations are observed\n  const callback = (mutationList) => {\n    for (const mutation of mutationList) {\n      if (mutation.type === 'childList') {\n        if (mutation.addedNodes.length !== 0) {\n          const allCompleteButtons = document.querySelectorAll('.complete-btn');\n\n          allCompleteButtons.forEach((button) => {\n            button.removeEventListener('click', () => {});\n\n            button.addEventListener('click', () => {\n              const listItem = button.parentElement as HTMLLIElement;\n              const pOrDel = listItem.children[1] as HTMLParagraphElement;\n              const todoText = pOrDel.textContent;\n\n              const del = document.createElement('del');\n              del.textContent = todoText;\n              del.className = 'list-item-text';\n\n              const p = document.createElement('p');\n              p.textContent = todoText;\n              p.className = 'list-item-text';\n              p.setAttribute('contenteditable', 'true');\n\n              if (pOrDel instanceof HTMLParagraphElement) {\n                listItem.replaceChild(del, pOrDel);\n              } else {\n                listItem.replaceChild(p, pOrDel);\n              }\n\n              if (listItem.dataset.id != null) {\n                const currentTodo = findTodo(listItem.dataset.id, model);\n                const opposite = !currentTodo.completed;\n                listItem.dataset.completed = String(opposite);\n\n                update('CompleteTodo', model, currentTodo);\n                saveToLocalStorage(model.AllTodos);\n              }\n            });\n          });\n        }\n      }\n    }\n  };\n\n  // Create an observer instance linked to the callback function\n  const observer = new MutationObserver(callback);\n\n  // Start observing the target node for configured mutations\n  observer.observe(ul, config);\n\n  // add a mutation so that the mutationObserver will automatically kick in\n  const newLi = document.createElement('li') as HTMLLIElement;\n  newLi.dataset.id = '000';\n  const shouldDelete = newLi;\n  ul.append(newLi);\n  if (shouldDelete.dataset.id === '000') {\n    shouldDelete.remove();\n  }\n})(init);\n\n// SET FILTER\n((model: Model) => {})(init);\n\n// ------------------------------------------------------------------------------\n//                              VIEW FUNCTIONS\n//-------------------------------------------------------------------------------\n\n/**\n * Displays all the todos from the global state unto the page\n * @param todos - The global state\n */\nfunction renderTodos(todos: Todo[]) {\n  ul.innerHTML = '';\n\n  let tempStorage: string[] = [];\n  for (const todo of todos) {\n    const determineElement = todo.completed ? 'del' : 'p';\n\n    tempStorage.push(\n      createListItem(\n        todo.id,\n        todo.value.trim(),\n        todo.completed,\n        determineElement\n      )\n    );\n    input.value = '';\n  }\n  ul.innerHTML = tempStorage.join('');\n}\n\n/**\n * Mutates a todo so that its completed data attribute is toggled\n * @param listItem - A list item currently appended to the DOM\n * @param value - What the completed data attribute should be set to\n */\nfunction toggleCompleteAttribute(listItem: HTMLLIElement, value: boolean) {\n  const isCompleted = value;\n\n  listItem.dataset.completed = isCompleted.toString();\n}\n\n/**\n * Removes a Todo <li> from the DOM\n * @param id - A unique id belonging to an object of type Todo\n * @param model - The global state\n * @param listElement - A list element to be removed\n * @returns {Todo} The deleted Todo object\n */\nfunction deleteTodo(\n  id: string,\n  model: Model,\n  listElement: HTMLLIElement\n): Todo {\n  const todo = findTodo(id, model);\n  listElement.remove();\n\n  return todo;\n}\n\n/**\n * Updates the global state, toggles the completed data attribute on a list item and replaces the p element with a del element if needed\n * @param e - A click event\n * @param model - The global state\n * @param el -\n */\nfunction handleCompletedClick(e: Event, model: Model, el = {}) {\n  const completeBtn = e.currentTarget as HTMLButtonElement;\n\n  const listItem = completeBtn.parentElement as HTMLLIElement;\n  const id = listItem.dataset.id;\n\n  if (id !== undefined) {\n    const currentTodo = findTodo(id, model);\n    currentTodo.completed = !currentTodo.completed;\n\n    // const determineElement = currentTodo.completed ? 'del' : 'p';\n\n    // const completedTodo = createListItem(\n    //   id,\n    //   currentTodo.value,\n    //   currentTodo.completed,\n    //   determineElement\n    // );\n\n    update('CompleteTodo', model, currentTodo);\n\n    toggleCompleteAttribute(listItem, currentTodo.completed);\n  }\n}\n\n// ------------------------------------------------------------------------------\n//                              HELPER FUNCTIONS\n//-------------------------------------------------------------------------------\n/**\n * Creates a list item\n * @param id - The unique ID of the list item todo\n * @param text - The actual todo itself\n * @param el - Represents an Html element, ins and del are semantically correct but a p tag can be used as well\n * @param completed - Reflects whether the complete button has been clicked or not\n * @returns {string} The inner HTML of the <li> including the li itself\n */\nfunction createListItem(\n  id: string,\n  text: string,\n  completed: boolean = false,\n  el: allowedElements = 'p'\n): string {\n  const listItem = `\n        <li class=\"list-item\" data-id=${id} data-completed=\"${completed}\">\n          <button class=\"complete-btn\">\n            <img src=\"/src/assets/images/icon-check.svg\" aria-hidden=\"true\" alt=\"\" />\n          </button>\n          <${el} class=\"list-item-text\" contenteditable=\"true\">${text}</${el}>\n          <button class=\"delete-btn todo-delete-icon\">\n            <img class=\"d\" src=\"/src/assets/images/icon-cross.svg\" alt=\"\" />\n          </button>\n        </li>\n    `;\n\n  return listItem;\n}\n\n/**\n * Checks if a string is empty. Will trim the the middle of the string\n * @param str - A string that will be checked\n * @returns {boolean} True if string is empty, false otherwise\n */\nfunction CheckIfEmptyString(str: string): boolean {\n  return str.trim() === '';\n}\n\n/**\n * Generates a unique id\n * @returns {string} A unique ID\n */\nfunction generateId(): string {\n  return Math.random().toString(36).slice(2);\n}\n\n/**\n * Creates an object of type Todo\n * @param value - A string which should be the actual todo itself\n * @returns {Todo} A todo object\n */\nfunction createTodoObject(value: string): Todo {\n  return {\n    id: generateId(),\n    value: value,\n    completed: false,\n  };\n}\n\n/**\n * Checks for the type of button being passed in\n * @param element - The button that was clicked on\n * @returns {validButton} A message stating the type of button that was clicked on\n * @throws {new Error} A string error built with the Error constructor\n * @example checkTypeOfButton(deleteBtn) -> 'delete-btn'\n */\nfunction checkTypeOfButton(element: HTMLButtonElement): validButton {\n  if (element.classList.contains('todo-delete-icon')) {\n    return 'delete-btn';\n  } else if (element.classList.contains('complete-btn')) {\n    return 'complete-btn';\n  } else {\n    return 'not-a-button';\n  }\n}\n\n/**\n * Finds a specific Todo based on an ID\n * @param id - A unique ID belonging to an object of type Todo\n * @param model - The global state\n * @returns {Todo} The Todo which matches the id passed in\n */\nfunction findTodo(id: string, model: Model): Todo {\n  const matchingTodo = model.AllTodos.filter((todo) => todo.id === id);\n\n  return matchingTodo[0];\n}\n\n/**\n * Saves users todos to local storage\n * @param todos - The global state that should be saved to local storage\n */\nfunction saveToLocalStorage(todos: Todo[]) {\n  const todoToJson = JSON.stringify(todos);\n  localStorage.setItem('todos', todoToJson);\n}\n\n/**\n * Retrieves a JSON string from localStorage\n * @param itemName - The key in the key:value pair of localStorage\n * @returns {string} Either a string of the users todos or an empty array\n */\nfunction getItemsFromLocalStorage(itemName: string): string {\n  const storage = localStorage.getItem(itemName);\n  return storage !== null ? storage : '[]';\n}\n\n/**\n * Parses the users todo's\n * @param item - Parses a string\n * @returns {Todo[]} An array of objects of type Todo\n */\nfunction parseTodos(item: string): Todo[] {\n  return JSON.parse(item);\n}\n\n/**\n * Simply for taking out the bloat from the script itself\n * @returns The example Todo\n */\nfunction renderListItemNode(template: HTMLTemplateElement): Todo {\n  const docFragment: DocumentFragment = template.content;\n  const listItemClone = docFragment.firstElementChild?.cloneNode(\n    true\n  ) as HTMLLIElement;\n\n  const id = listItemClone.dataset.id as string;\n  const pEl = listItemClone.childNodes[3];\n  const text = pEl.textContent?.trim() as string;\n\n  const newTodo: Todo = {\n    id: id,\n    value: text,\n    completed: false,\n  };\n\n  return newTodo;\n}\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvdHMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBOztBQUNBLElBQU0sUUFBUSxTQUFTLGdCQUFULENBQ1osaUJBRFksQ0FBZDtBQUdBLElBQU0sT0FBTyxTQUFTLGFBQVQsQ0FBdUIsa0JBQXZCLENBQWI7QUFDQSxJQUFNLFFBQVEsU0FBUyxhQUFULENBQXVCLGFBQXZCLENBQWQ7QUFDQSxJQUFNLEtBQUssU0FBUyxhQUFULENBQXVCLE9BQXZCLENBQVg7QUFDQSxJQUFNLFdBQVcsU0FBUyxhQUFULENBQ2Ysb0JBRGUsQ0FBakI7QUF3QkE7QUFDQTtBQUNBO0FBQ0EsSUFBTSxPQUFjO0FBQ2xCLGNBQVU7QUFEUSxDQUFwQjtBQUdBLE9BQU8sTUFBUCxDQUFjLElBQWQ7QUFPQSxTQUFTLE1BQVQsQ0FBZ0IsR0FBaEIsRUFBMEIsS0FBMUIsRUFBd0MsS0FBeEMsRUFBbUQ7QUFDakQsWUFBUSxHQUFSO0FBQ0UsYUFBSyxTQUFMO0FBQ0Usa0JBQU0sUUFBTixDQUFlLElBQWYsQ0FBb0IsS0FBcEI7QUFDQTtBQUVGLGFBQUssWUFBTDtBQUNFLGtCQUFNLFFBQU4sQ0FBZSxPQUFmLENBQXVCLFVBQUMsSUFBRCxFQUFTO0FBQzlCLG9CQUFJLEtBQUssRUFBTCxLQUFZLE1BQU0sRUFBdEIsRUFBMEI7QUFDeEIsd0JBQU0sUUFBUSxNQUFNLFFBQU4sQ0FBZSxPQUFmLENBQXVCLElBQXZCLENBQWQ7QUFDQSwwQkFBTSxRQUFOLENBQWUsTUFBZixDQUFzQixLQUF0QixFQUE2QixDQUE3QjtBQUNEO0FBQ0YsYUFMRDtBQU1BO0FBRUYsYUFBSyxZQUFMO0FBQ0Usa0JBQU0sUUFBTixDQUFlLE9BQWYsQ0FBdUIsVUFBQyxJQUFELEVBQVM7QUFDOUIs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QUZhO0FBR3BCLG1CQUFXO0FBSFMsS0FBdEI7QUFNQSxXQUFPLE9BQVA7QUFDRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIi8vIFdIRU4gVVNFUiBDTElDS1MgT04gQ09NUExFVEVEIEJVVFRPTiwgQUREIEdSQURJRU5UXG4vLyBnZXQgdGhlIGlkIG9mIHRoZSB0b2RvXG4vLyBmaW5kIHRoZSBzcGVjaWZpYyB0b2RvXG4vLyBjaGFuZ2UgdGhlIGNvbXBsZXRlZCBwcm9wZXJ0eSB0byB0cnVlXG4vLyBTYXZlIHRoZSBzdGF0ZVxuXG4vLyBXSEVOIFVTRVIgQ0xJQ0tTIE9OIENPTVBMRVRFRCBCVVRUT04sIEFERCBMSU5FIFRIUk9VR0hcbi8vIGdldCB0aGUgaWQgb2YgdGhlIHRvZG9cbi8vIGZpbmQgdGhlIHNwZWNpZmljIHRvZG9cbi8vIGNoYW5nZSB0aGUgcCB0YWcgdG8gYSBkZWwgdGFnXG4vLyAtPiBUaGlzIHdpbGwgcHJvYmFibHkgcmVxdWlyZSBzb21lIHVwZGF0aW5nIG9mIHRoZSByZW5kZXJMaXN0SXRlbSBmdW5jdGlvblxuLy8gLT4gTWF5IGFsc28gYmUgYmV0dGVyIHRvIGNyZWF0ZSBhIGZ1bmN0aW9uIHRvIHJlbmRlciBhIHNpbmdsZSB0b2RvIHJhdGhlciB0aGFuIHJlLXJlbmRlciBhbGwgb2YgdGhlbVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRE9NIE5PREVTXG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuY29uc3QgdG9kb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxuICAnLnRvZG8tbGlzdC1pdGVtJ1xuKSBhcyBOb2RlTGlzdE9mPEhUTUxMSUVsZW1lbnQ+O1xuY29uc3QgZm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYmFyLWZvcm0nKSBhcyBIVE1MRm9ybUVsZW1lbnQ7XG5jb25zdCBpbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jcmVhdGUtYmFyJykgYXMgSFRNTElucHV0RWxlbWVudDtcbmNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxpc3QnKSBhcyBIVE1MVUxpc3RFbGVtZW50O1xuY29uc3QgdGVtcGxhdGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAnI2V4YW1wbGUtbGlzdC1pdGVtJ1xuKSBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVFlQRVNcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxudHlwZSBUb2RvID0ge1xuICBpZDogc3RyaW5nO1xuICB2YWx1ZTogc3RyaW5nO1xuICBjb21wbGV0ZWQ6IGJvb2xlYW47XG59O1xuXG50eXBlIHZhbGlkQnV0dG9uID0gJ2RlbGV0ZS1idG4nIHwgJ2NvbXBsZXRlLWJ0bicgfCAnbm90LWEtYnV0dG9uJztcblxudHlwZSBhbGxvd2VkRWxlbWVudHMgPSAncCcgfCAnaW5zJyB8ICdkZWwnO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgTU9ERUxcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxudHlwZSBNb2RlbCA9IHtcbiAgQWxsVG9kb3M6IFRvZG9bXTtcbn07XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR0xPQkFMIFNUQVRFXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbmNvbnN0IGluaXQ6IE1vZGVsID0ge1xuICBBbGxUb2RvczogW10sXG59O1xuT2JqZWN0LmZyZWV6ZShpbml0KTtcblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVVBEQVRFIEZVTkNUSU9OXG4vLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbnR5cGUgTXNnID0gJ0FkZFRvZG8nIHwgJ1JlbW92ZVRvZG8nIHwgJ1VwZGF0ZVRvZG8nIHwgJ0NvbXBsZXRlVG9kbyc7XG5cbmZ1bmN0aW9uIHVwZGF0ZShtc2c6IE1zZywgbW9kZWw6IE1vZGVsLCB2YWx1ZTogVG9kbyk6IHZvaWQge1xuICBzd2l0Y2ggKG1zZykge1xuICAgIGNhc2UgJ0FkZFRvZG8nOlxuICAgICAgbW9kZWwuQWxsVG9kb3MucHVzaCh2YWx1ZSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ1JlbW92ZVRvZG8nOlxuICAgICAgbW9kZWwuQWxsVG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgICBpZiAodG9kby5pZCA9PT0gdmFsdWUuaWQpIHtcbiAgICAgICAgICBjb25zdCBpbmRleCA9IG1vZGVsLkFsbFRvZG9zLmluZGV4T2YodG9kbyk7XG4gICAgICAgICAgbW9kZWwuQWxsVG9kb3Muc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ1VwZGF0ZVRvZG8nOlxuICAgICAgbW9kZWwuQWxsVG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgICBpZiAodG9kby5pZCA9PT0gdmFsdWUuaWQpIHtcbiAgICAgICAgICBjb25zdCBpbmRleCA9IG1vZGVsLkFsbFRvZG9zLmluZGV4T2YodG9kbyk7XG4gICAgICAgICAgbW9kZWwuQWxsVG9kb3NbaW5kZXhdLnZhbHVlID0gdmFsdWUudmFsdWU7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdDb21wbGV0ZVRvZG8nOlxuICAgICAgbW9kZWwuQWxsVG9kb3MuZm9yRWFjaCgodG9kbykgPT4ge1xuICAgICAgICBpZiAodG9kby5pZCA9PT0gdmFsdWUuaWQpIHtcbiAgICAgICAgICBjb25zdCBpbmRleCA9IG1vZGVsLkFsbFRvZG9zLmluZGV4T2YodG9kbyk7XG4gICAgICAgICAgbW9kZWwuQWxsVG9kb3NbaW5kZXhdLmNvbXBsZXRlZCA9ICF2YWx1ZS5jb21wbGV0ZWQ7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgYnJlYWs7XG4gIH1cbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgU0NSSVBUU1xuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbi8vIEdFVCBUT0RPUyBGUk9NIExPQ0FMIFNUT1JBR0UgQU5EIERJU1BMQVkgVEhFTVxuKChtb2RlbDogTW9kZWwpID0+IHtcbiAgY29uc3QgZ2V0U3RvcmVkVG9kb3M6IHN0cmluZyA9IGdldEl0ZW1zRnJvbUxvY2FsU3RvcmFnZSgndG9kb3MnKTtcbiAgY29uc3QgcGFyc2VTdG9yZWRUb2RvczogVG9kb1tdID0gcGFyc2VUb2RvcyhnZXRTdG9yZWRUb2Rvcyk7XG5cbiAgLy8gaWYgdGhlcmUncmUgbm8gcHJldmlvdXMgdG9kbydzLCBjcmVhdGUgZXhhbXBsZSB0b2RvXG4gIGlmIChwYXJzZVN0b3JlZFRvZG9zLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IG5ld1RvZG8gPSByZW5kZXJMaXN0SXRlbU5vZGUodGVtcGxhdGUpO1xuICAgIHVwZGF0ZSgnQWRkVG9kbycsIG1vZGVsLCBuZXdUb2RvKTtcbiAgfSBlbHNlIHtcbiAgICBmb3IgKGNvbnN0IHRvZG8gb2YgcGFyc2VTdG9yZWRUb2Rvcykge1xuICAgICAgdXBkYXRlKCdBZGRUb2RvJywgbW9kZWwsIHRvZG8pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlclRvZG9zKG1vZGVsLkFsbFRvZG9zKTtcblxuICAvLyBhZGQgZXZlbnQgbGlzdGVuZXIgdG8gaW5pdGlhbCB0b2RvIHNvIHRoYXQgaXQgY2FuIGJlIHNldCB0byBjb21wbGV0ZSBhcyB3ZWxsXG4gIGNvbnN0IGFsbFRvZG9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbXBsZXRlLWJ0bicpO1xuICBhbGxUb2Rvcy5mb3JFYWNoKCh0b2RvKSA9PiB7XG4gICAgdG9kby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgICAvLyBoYW5kbGVDb21wbGV0ZWRDbGljayhlLCBtb2RlbCk7XG4gICAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UobW9kZWwuQWxsVG9kb3MpO1xuICAgIH0pO1xuICB9KTtcbn0pKGluaXQpO1xuXG4vLyBDUkVBVEUgTkVXIFRPRE9TXG4oKG1vZGVsOiBNb2RlbCkgPT4ge1xuICBmb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChlKSA9PiB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGdldFVzZXJJbnB1dCA9IGlucHV0LnZhbHVlLnRyaW0oKTtcbiAgICBjb25zdCBpc1VzZXJJbnB1dEVtcHR5ID0gQ2hlY2tJZkVtcHR5U3RyaW5nKGdldFVzZXJJbnB1dCk7XG4gICAgY29uc3QgY3JlYXRlTmV3VG9kbyA9IGNyZWF0ZVRvZG9PYmplY3QoZ2V0VXNlcklucHV0KTtcblxuICAgIGlmICghaXNVc2VySW5wdXRFbXB0eSkge1xuICAgICAgdXBkYXRlKCdBZGRUb2RvJywgbW9kZWwsIGNyZWF0ZU5ld1RvZG8pO1xuICAgICAgc2F2ZVRvTG9jYWxTdG9yYWdlKG1vZGVsLkFsbFRvZG9zKTtcbiAgICB9XG5cbiAgICByZW5kZXJUb2Rvcyhtb2RlbC5BbGxUb2Rvcyk7XG4gIH0pO1xufSkoaW5pdCk7XG5cbi8vIERFTEVURSBUT0RPU1xuKChtb2RlbDogTW9kZWwpID0+IHtcbiAgdWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGNvbnN0IHhJbWFnZSA9IGUudGFyZ2V0IGFzIEhUTUxJbWFnZUVsZW1lbnQ7XG4gICAgY29uc3QgYnV0dG9uID0geEltYWdlLnBhcmVudEVsZW1lbnQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cbiAgICBjb25zdCBsaSA9IGJ1dHRvbi5wYXJlbnRFbGVtZW50IGFzIEhUTUxMSUVsZW1lbnQ7XG5cbiAgICBjb25zdCB0b2RvSWQgPSBsaS5kYXRhc2V0LmlkIGFzIHN0cmluZztcbiAgICBjb25zdCBpc0RlbGV0ZU9yVXBkYXRlQnRuID0gY2hlY2tUeXBlT2ZCdXR0b24oYnV0dG9uKTtcblxuICAgIGlmIChpc0RlbGV0ZU9yVXBkYXRlQnRuID09PSAnZGVsZXRlLWJ0bicpIHtcbiAgICAgIGNvbnN0IHRvZG9UaGF0U2hvdWxkQmVEZWxldGVkID0gZmluZFRvZG8odG9kb0lkLCBtb2RlbCk7XG4gICAgICBkZWxldGVUb2RvKHRvZG9UaGF0U2hvdWxkQmVEZWxldGVkLmlkLCBtb2RlbCwgbGkpO1xuICAgICAgdXBkYXRlKCdSZW1vdmVUb2RvJywgbW9kZWwsIHRvZG9UaGF0U2hvdWxkQmVEZWxldGVkKTtcbiAgICAgIHNhdmVUb0xvY2FsU3RvcmFnZShtb2RlbC5BbGxUb2Rvcyk7XG4gICAgfVxuICB9KTtcbn0pKGluaXQpO1xuXG4vLyBVUERBVEUgVE9ET1NcbigobW9kZWw6IE1vZGVsKSA9PiB7XG4gIHVsLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3Vzb3V0JywgKGUpID0+IHtcbiAgICBjb25zdCB0YXJnZXQgPSBlLnRhcmdldDtcblxuICAgIGlmICh0YXJnZXQgaW5zdGFuY2VvZiBIVE1MUGFyYWdyYXBoRWxlbWVudCkge1xuICAgICAgY29uc3QgdGV4dCA9IHRhcmdldC50ZXh0Q29udGVudCAhPT0gbnVsbCA/IHRhcmdldC50ZXh0Q29udGVudCA6ICcnO1xuICAgICAgY29uc3QgbGlzdEl0ZW0gPSB0YXJnZXQucGFyZW50RWxlbWVudCBhcyBIVE1MTElFbGVtZW50O1xuICAgICAgY29uc3QgbGlzdEl0ZW1JRCA9IGxpc3RJdGVtLmRhdGFzZXQuaWQ7XG5cbiAgICAgIGlmIChsaXN0SXRlbUlEICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFRvZG86IFRvZG8gPSB7XG4gICAgICAgICAgaWQ6IGxpc3RJdGVtSUQsXG4gICAgICAgICAgdmFsdWU6IHRleHQsXG4gICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBuZXdDaGlsZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RlbCcpO1xuICAgICAgICBuZXdDaGlsZC5jbGFzc05hbWUgPSAnbGlzdC1pdGVtLXRleHQnO1xuICAgICAgICBuZXdDaGlsZC50ZXh0Q29udGVudCA9IHRleHQ7XG4gICAgICAgIGNvbnN0IG9sZENoaWxkID0gdGFyZ2V0O1xuICAgICAgICBjb25zdCBwYXJlbnQgPSBsaXN0SXRlbTtcblxuICAgICAgICBjb25zdCByZXBsYWNlbWVudEluZm8gPSB7IHBhcmVudCwgbmV3Q2hpbGQsIG9sZENoaWxkIH07XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcGxhY2VtZW50SW5mbyk7XG5cbiAgICAgICAgdXBkYXRlKCdVcGRhdGVUb2RvJywgbW9kZWwsIHVwZGF0ZWRUb2RvKTtcbiAgICAgICAgLy8gaGFuZGxlQ29tcGxldGVkQ2xpY2soZSwgbW9kZWwsIHJlcGxhY2VtZW50SW5mbyk7XG4gICAgICAgIHNhdmVUb0xvY2FsU3RvcmFnZShtb2RlbC5BbGxUb2Rvcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaGlzIGxpc3QgaXRlbSBkb2Vzbid0IGhhdmUgYW4gSURcIik7XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn0pKGluaXQpO1xuXG4vLyBDT01QTEVURSBUT0RPXG4oKG1vZGVsOiBNb2RlbCkgPT4ge1xuICAvLyBPcHRpb25zIGZvciB0aGUgb2JzZXJ2ZXIgKHdoaWNoIG11dGF0aW9ucyB0byBvYnNlcnZlKVxuICBjb25zdCBjb25maWcgPSB7IGNoaWxkTGlzdDogdHJ1ZSB9O1xuXG4gIC8vIENhbGxiYWNrIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgd2hlbiBtdXRhdGlvbnMgYXJlIG9ic2VydmVkXG4gIGNvbnN0IGNhbGxiYWNrID0gKG11dGF0aW9uTGlzdCkgPT4ge1xuICAgIGZvciAoY29uc3QgbXV0YXRpb24gb2YgbXV0YXRpb25MaXN0KSB7XG4gICAgICBpZiAobXV0YXRpb24udHlwZSA9PT0gJ2NoaWxkTGlzdCcpIHtcbiAgICAgICAgaWYgKG11dGF0aW9uLmFkZGVkTm9kZXMubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgY29uc3QgYWxsQ29tcGxldGVCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbXBsZXRlLWJ0bicpO1xuXG4gICAgICAgICAgYWxsQ29tcGxldGVCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge30pO1xuXG4gICAgICAgICAgICBidXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGxpc3RJdGVtID0gYnV0dG9uLnBhcmVudEVsZW1lbnQgYXMgSFRNTExJRWxlbWVudDtcbiAgICAgICAgICAgICAgY29uc3QgcE9yRGVsID0gbGlzdEl0ZW0uY2hpbGRyZW5bMV0gYXMgSFRNTFBhcmFncmFwaEVsZW1lbnQ7XG4gICAgICAgICAgICAgIGNvbnN0IHRvZG9UZXh0ID0gcE9yRGVsLnRleHRDb250ZW50O1xuXG4gICAgICAgICAgICAgIGNvbnN0IGRlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RlbCcpO1xuICAgICAgICAgICAgICBkZWwudGV4dENvbnRlbnQgPSB0b2RvVGV4dDtcbiAgICAgICAgICAgICAgZGVsLmNsYXNzTmFtZSA9ICdsaXN0LWl0ZW0tdGV4dCc7XG5cbiAgICAgICAgICAgICAgY29uc3QgcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICAgICAgICAgICAgcC50ZXh0Q29udGVudCA9IHRvZG9UZXh0O1xuICAgICAgICAgICAgICBwLmNsYXNzTmFtZSA9ICdsaXN0LWl0ZW0tdGV4dCc7XG4gICAgICAgICAgICAgIHAuc2V0QXR0cmlidXRlKCdjb250ZW50ZWRpdGFibGUnLCAndHJ1ZScpO1xuXG4gICAgICAgICAgICAgIGlmIChwT3JEZWwgaW5zdGFuY2VvZiBIVE1MUGFyYWdyYXBoRWxlbWVudCkge1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLnJlcGxhY2VDaGlsZChkZWwsIHBPckRlbCk7XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGlzdEl0ZW0ucmVwbGFjZUNoaWxkKHAsIHBPckRlbCk7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBpZiAobGlzdEl0ZW0uZGF0YXNldC5pZCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudFRvZG8gPSBmaW5kVG9kbyhsaXN0SXRlbS5kYXRhc2V0LmlkLCBtb2RlbCk7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3Bwb3NpdGUgPSAhY3VycmVudFRvZG8uY29tcGxldGVkO1xuICAgICAgICAgICAgICAgIGxpc3RJdGVtLmRhdGFzZXQuY29tcGxldGVkID0gU3RyaW5nKG9wcG9zaXRlKTtcblxuICAgICAgICAgICAgICAgIHVwZGF0ZSgnQ29tcGxldGVUb2RvJywgbW9kZWwsIGN1cnJlbnRUb2RvKTtcbiAgICAgICAgICAgICAgICBzYXZlVG9Mb2NhbFN0b3JhZ2UobW9kZWwuQWxsVG9kb3MpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvLyBDcmVhdGUgYW4gb2JzZXJ2ZXIgaW5zdGFuY2UgbGlua2VkIHRvIHRoZSBjYWxsYmFjayBmdW5jdGlvblxuICBjb25zdCBvYnNlcnZlciA9IG5ldyBNdXRhdGlvbk9ic2VydmVyKGNhbGxiYWNrKTtcblxuICAvLyBTdGFydCBvYnNlcnZpbmcgdGhlIHRhcmdldCBub2RlIGZvciBjb25maWd1cmVkIG11dGF0aW9uc1xuICBvYnNlcnZlci5vYnNlcnZlKHVsLCBjb25maWcpO1xuXG4gIC8vIGFkZCBhIG11dGF0aW9uIHNvIHRoYXQgdGhlIG11dGF0aW9uT2JzZXJ2ZXIgd2lsbCBhdXRvbWF0aWNhbGx5IGtpY2sgaW5cbiAgY29uc3QgbmV3TGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpIGFzIEhUTUxMSUVsZW1lbnQ7XG4gIG5ld0xpLmRhdGFzZXQuaWQgPSAnMDAwJztcbiAgY29uc3Qgc2hvdWxkRGVsZXRlID0gbmV3TGk7XG4gIHVsLmFwcGVuZChuZXdMaSk7XG4gIGlmIChzaG91bGREZWxldGUuZGF0YXNldC5pZCA9PT0gJzAwMCcpIHtcbiAgICBzaG91bGREZWxldGUucmVtb3ZlKCk7XG4gIH1cbn0pKGluaXQpO1xuXG4vLyBTRVQgRklMVEVSXG4oKG1vZGVsOiBNb2RlbCkgPT4ge30pKGluaXQpO1xuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVklFVyBGVU5DVElPTlNcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vKipcbiAqIERpc3BsYXlzIGFsbCB0aGUgdG9kb3MgZnJvbSB0aGUgZ2xvYmFsIHN0YXRlIHVudG8gdGhlIHBhZ2VcbiAqIEBwYXJhbSB0b2RvcyAtIFRoZSBnbG9iYWwgc3RhdGVcbiAqL1xuZnVuY3Rpb24gcmVuZGVyVG9kb3ModG9kb3M6IFRvZG9bXSkge1xuICB1bC5pbm5lckhUTUwgPSAnJztcblxuICBsZXQgdGVtcFN0b3JhZ2U6IHN0cmluZ1tdID0gW107XG4gIGZvciAoY29uc3QgdG9kbyBvZiB0b2Rvcykge1xuICAgIGNvbnN0IGRldGVybWluZUVsZW1lbnQgPSB0b2RvLmNvbXBsZXRlZCA/ICdkZWwnIDogJ3AnO1xuXG4gICAgdGVtcFN0b3JhZ2UucHVzaChcbiAgICAgIGNyZWF0ZUxpc3RJdGVtKFxuICAgICAgICB0b2RvLmlkLFxuICAgICAgICB0b2RvLnZhbHVlLnRyaW0oKSxcbiAgICAgICAgdG9kby5jb21wbGV0ZWQsXG4gICAgICAgIGRldGVybWluZUVsZW1lbnRcbiAgICAgIClcbiAgICApO1xuICAgIGlucHV0LnZhbHVlID0gJyc7XG4gIH1cbiAgdWwuaW5uZXJIVE1MID0gdGVtcFN0b3JhZ2Uuam9pbignJyk7XG59XG5cbi8qKlxuICogTXV0YXRlcyBhIHRvZG8gc28gdGhhdCBpdHMgY29tcGxldGVkIGRhdGEgYXR0cmlidXRlIGlzIHRvZ2dsZWRcbiAqIEBwYXJhbSBsaXN0SXRlbSAtIEEgbGlzdCBpdGVtIGN1cnJlbnRseSBhcHBlbmRlZCB0byB0aGUgRE9NXG4gKiBAcGFyYW0gdmFsdWUgLSBXaGF0IHRoZSBjb21wbGV0ZWQgZGF0YSBhdHRyaWJ1dGUgc2hvdWxkIGJlIHNldCB0b1xuICovXG5mdW5jdGlvbiB0b2dnbGVDb21wbGV0ZUF0dHJpYnV0ZShsaXN0SXRlbTogSFRNTExJRWxlbWVudCwgdmFsdWU6IGJvb2xlYW4pIHtcbiAgY29uc3QgaXNDb21wbGV0ZWQgPSB2YWx1ZTtcblxuICBsaXN0SXRlbS5kYXRhc2V0LmNvbXBsZXRlZCA9IGlzQ29tcGxldGVkLnRvU3RyaW5nKCk7XG59XG5cbi8qKlxuICogUmVtb3ZlcyBhIFRvZG8gPGxpPiBmcm9tIHRoZSBET01cbiAqIEBwYXJhbSBpZCAtIEEgdW5pcXVlIGlkIGJlbG9uZ2luZyB0byBhbiBvYmplY3Qgb2YgdHlwZSBUb2RvXG4gKiBAcGFyYW0gbW9kZWwgLSBUaGUgZ2xvYmFsIHN0YXRlXG4gKiBAcGFyYW0gbGlzdEVsZW1lbnQgLSBBIGxpc3QgZWxlbWVudCB0byBiZSByZW1vdmVkXG4gKiBAcmV0dXJucyB7VG9kb30gVGhlIGRlbGV0ZWQgVG9kbyBvYmplY3RcbiAqL1xuZnVuY3Rpb24gZGVsZXRlVG9kbyhcbiAgaWQ6IHN0cmluZyxcbiAgbW9kZWw6IE1vZGVsLFxuICBsaXN0RWxlbWVudDogSFRNTExJRWxlbWVudFxuKTogVG9kbyB7XG4gIGNvbnN0IHRvZG8gPSBmaW5kVG9kbyhpZCwgbW9kZWwpO1xuICBsaXN0RWxlbWVudC5yZW1vdmUoKTtcblxuICByZXR1cm4gdG9kbztcbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBnbG9iYWwgc3RhdGUsIHRvZ2dsZXMgdGhlIGNvbXBsZXRlZCBkYXRhIGF0dHJpYnV0ZSBvbiBhIGxpc3QgaXRlbSBhbmQgcmVwbGFjZXMgdGhlIHAgZWxlbWVudCB3aXRoIGEgZGVsIGVsZW1lbnQgaWYgbmVlZGVkXG4gKiBAcGFyYW0gZSAtIEEgY2xpY2sgZXZlbnRcbiAqIEBwYXJhbSBtb2RlbCAtIFRoZSBnbG9iYWwgc3RhdGVcbiAqIEBwYXJhbSBlbCAtXG4gKi9cbmZ1bmN0aW9uIGhhbmRsZUNvbXBsZXRlZENsaWNrKGU6IEV2ZW50LCBtb2RlbDogTW9kZWwsIGVsID0ge30pIHtcbiAgY29uc3QgY29tcGxldGVCdG4gPSBlLmN1cnJlbnRUYXJnZXQgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cbiAgY29uc3QgbGlzdEl0ZW0gPSBjb21wbGV0ZUJ0bi5wYXJlbnRFbGVtZW50IGFzIEhUTUxMSUVsZW1lbnQ7XG4gIGNvbnN0IGlkID0gbGlzdEl0ZW0uZGF0YXNldC5pZDtcblxuICBpZiAoaWQgIT09IHVuZGVmaW5lZCkge1xuICAgIGNvbnN0IGN1cnJlbnRUb2RvID0gZmluZFRvZG8oaWQsIG1vZGVsKTtcbiAgICBjdXJyZW50VG9kby5jb21wbGV0ZWQgPSAhY3VycmVudFRvZG8uY29tcGxldGVkO1xuXG4gICAgLy8gY29uc3QgZGV0ZXJtaW5lRWxlbWVudCA9IGN1cnJlbnRUb2RvLmNvbXBsZXRlZCA/ICdkZWwnIDogJ3AnO1xuXG4gICAgLy8gY29uc3QgY29tcGxldGVkVG9kbyA9IGNyZWF0ZUxpc3RJdGVtKFxuICAgIC8vICAgaWQsXG4gICAgLy8gICBjdXJyZW50VG9kby52YWx1ZSxcbiAgICAvLyAgIGN1cnJlbnRUb2RvLmNvbXBsZXRlZCxcbiAgICAvLyAgIGRldGVybWluZUVsZW1lbnRcbiAgICAvLyApO1xuXG4gICAgdXBkYXRlKCdDb21wbGV0ZVRvZG8nLCBtb2RlbCwgY3VycmVudFRvZG8pO1xuXG4gICAgdG9nZ2xlQ29tcGxldGVBdHRyaWJ1dGUobGlzdEl0ZW0sIGN1cnJlbnRUb2RvLmNvbXBsZXRlZCk7XG4gIH1cbn1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEhFTFBFUiBGVU5DVElPTlNcbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLyoqXG4gKiBDcmVhdGVzIGEgbGlzdCBpdGVtXG4gKiBAcGFyYW0gaWQgLSBUaGUgdW5pcXVlIElEIG9mIHRoZSBsaXN0IGl0ZW0gdG9kb1xuICogQHBhcmFtIHRleHQgLSBUaGUgYWN0dWFsIHRvZG8gaXRzZWxmXG4gKiBAcGFyYW0gZWwgLSBSZXByZXNlbnRzIGFuIEh0bWwgZWxlbWVudCwgaW5zIGFuZCBkZWwgYXJlIHNlbWFudGljYWxseSBjb3JyZWN0IGJ1dCBhIHAgdGFnIGNhbiBiZSB1c2VkIGFzIHdlbGxcbiAqIEBwYXJhbSBjb21wbGV0ZWQgLSBSZWZsZWN0cyB3aGV0aGVyIHRoZSBjb21wbGV0ZSBidXR0b24gaGFzIGJlZW4gY2xpY2tlZCBvciBub3RcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBpbm5lciBIVE1MIG9mIHRoZSA8bGk+IGluY2x1ZGluZyB0aGUgbGkgaXRzZWxmXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUxpc3RJdGVtKFxuICBpZDogc3RyaW5nLFxuICB0ZXh0OiBzdHJpbmcsXG4gIGNvbXBsZXRlZDogYm9vbGVhbiA9IGZhbHNlLFxuICBlbDogYWxsb3dlZEVsZW1lbnRzID0gJ3AnXG4pOiBzdHJpbmcge1xuICBjb25zdCBsaXN0SXRlbSA9IGBcbiAgICAgICAgPGxpIGNsYXNzPVwibGlzdC1pdGVtXCIgZGF0YS1pZD0ke2lkfSBkYXRhLWNvbXBsZXRlZD1cIiR7Y29tcGxldGVkfVwiPlxuICAgICAgICAgIDxidXR0b24gY2xhc3M9XCJjb21wbGV0ZS1idG5cIj5cbiAgICAgICAgICAgIDxpbWcgc3JjPVwiL3NyYy9hc3NldHMvaW1hZ2VzL2ljb24tY2hlY2suc3ZnXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgYWx0PVwiXCIgLz5cbiAgICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgICA8JHtlbH0gY2xhc3M9XCJsaXN0LWl0ZW0tdGV4dFwiIGNvbnRlbnRlZGl0YWJsZT1cInRydWVcIj4ke3RleHR9PC8ke2VsfT5cbiAgICAgICAgICA8YnV0dG9uIGNsYXNzPVwiZGVsZXRlLWJ0biB0b2RvLWRlbGV0ZS1pY29uXCI+XG4gICAgICAgICAgICA8aW1nIGNsYXNzPVwiZFwiIHNyYz1cIi9zcmMvYXNzZXRzL2ltYWdlcy9pY29uLWNyb3NzLnN2Z1wiIGFsdD1cIlwiIC8+XG4gICAgICAgICAgPC9idXR0b24+XG4gICAgICAgIDwvbGk+XG4gICAgYDtcblxuICByZXR1cm4gbGlzdEl0ZW07XG59XG5cbi8qKlxuICogQ2hlY2tzIGlmIGEgc3RyaW5nIGlzIGVtcHR5LiBXaWxsIHRyaW0gdGhlIHRoZSBtaWRkbGUgb2YgdGhlIHN0cmluZ1xuICogQHBhcmFtIHN0ciAtIEEgc3RyaW5nIHRoYXQgd2lsbCBiZSBjaGVja2VkXG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBzdHJpbmcgaXMgZW1wdHksIGZhbHNlIG90aGVyd2lzZVxuICovXG5mdW5jdGlvbiBDaGVja0lmRW1wdHlTdHJpbmcoc3RyOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgcmV0dXJuIHN0ci50cmltKCkgPT09ICcnO1xufVxuXG4vKipcbiAqIEdlbmVyYXRlcyBhIHVuaXF1ZSBpZFxuICogQHJldHVybnMge3N0cmluZ30gQSB1bmlxdWUgSURcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVJZCgpOiBzdHJpbmcge1xuICByZXR1cm4gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc2xpY2UoMik7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhbiBvYmplY3Qgb2YgdHlwZSBUb2RvXG4gKiBAcGFyYW0gdmFsdWUgLSBBIHN0cmluZyB3aGljaCBzaG91bGQgYmUgdGhlIGFjdHVhbCB0b2RvIGl0c2VsZlxuICogQHJldHVybnMge1RvZG99IEEgdG9kbyBvYmplY3RcbiAqL1xuZnVuY3Rpb24gY3JlYXRlVG9kb09iamVjdCh2YWx1ZTogc3RyaW5nKTogVG9kbyB7XG4gIHJldHVybiB7XG4gICAgaWQ6IGdlbmVyYXRlSWQoKSxcbiAgICB2YWx1ZTogdmFsdWUsXG4gICAgY29tcGxldGVkOiBmYWxzZSxcbiAgfTtcbn1cblxuLyoqXG4gKiBDaGVja3MgZm9yIHRoZSB0eXBlIG9mIGJ1dHRvbiBiZWluZyBwYXNzZWQgaW5cbiAqIEBwYXJhbSBlbGVtZW50IC0gVGhlIGJ1dHRvbiB0aGF0IHdhcyBjbGlja2VkIG9uXG4gKiBAcmV0dXJucyB7dmFsaWRCdXR0b259IEEgbWVzc2FnZSBzdGF0aW5nIHRoZSB0eXBlIG9mIGJ1dHRvbiB0aGF0IHdhcyBjbGlja2VkIG9uXG4gKiBAdGhyb3dzIHtuZXcgRXJyb3J9IEEgc3RyaW5nIGVycm9yIGJ1aWx0IHdpdGggdGhlIEVycm9yIGNvbnN0cnVjdG9yXG4gKiBAZXhhbXBsZSBjaGVja1R5cGVPZkJ1dHRvbihkZWxldGVCdG4pIC0+ICdkZWxldGUtYnRuJ1xuICovXG5mdW5jdGlvbiBjaGVja1R5cGVPZkJ1dHRvbihlbGVtZW50OiBIVE1MQnV0dG9uRWxlbWVudCk6IHZhbGlkQnV0dG9uIHtcbiAgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCd0b2RvLWRlbGV0ZS1pY29uJykpIHtcbiAgICByZXR1cm4gJ2RlbGV0ZS1idG4nO1xuICB9IGVsc2UgaWYgKGVsZW1lbnQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb21wbGV0ZS1idG4nKSkge1xuICAgIHJldHVybiAnY29tcGxldGUtYnRuJztcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gJ25vdC1hLWJ1dHRvbic7XG4gIH1cbn1cblxuLyoqXG4gKiBGaW5kcyBhIHNwZWNpZmljIFRvZG8gYmFzZWQgb24gYW4gSURcbiAqIEBwYXJhbSBpZCAtIEEgdW5pcXVlIElEIGJlbG9uZ2luZyB0byBhbiBvYmplY3Qgb2YgdHlwZSBUb2RvXG4gKiBAcGFyYW0gbW9kZWwgLSBUaGUgZ2xvYmFsIHN0YXRlXG4gKiBAcmV0dXJucyB7VG9kb30gVGhlIFRvZG8gd2hpY2ggbWF0Y2hlcyB0aGUgaWQgcGFzc2VkIGluXG4gKi9cbmZ1bmN0aW9uIGZpbmRUb2RvKGlkOiBzdHJpbmcsIG1vZGVsOiBNb2RlbCk6IFRvZG8ge1xuICBjb25zdCBtYXRjaGluZ1RvZG8gPSBtb2RlbC5BbGxUb2Rvcy5maWx0ZXIoKHRvZG8pID0+IHRvZG8uaWQgPT09IGlkKTtcblxuICByZXR1cm4gbWF0Y2hpbmdUb2RvWzBdO1xufVxuXG4vKipcbiAqIFNhdmVzIHVzZXJzIHRvZG9zIHRvIGxvY2FsIHN0b3JhZ2VcbiAqIEBwYXJhbSB0b2RvcyAtIFRoZSBnbG9iYWwgc3RhdGUgdGhhdCBzaG91bGQgYmUgc2F2ZWQgdG8gbG9jYWwgc3RvcmFnZVxuICovXG5mdW5jdGlvbiBzYXZlVG9Mb2NhbFN0b3JhZ2UodG9kb3M6IFRvZG9bXSkge1xuICBjb25zdCB0b2RvVG9Kc29uID0gSlNPTi5zdHJpbmdpZnkodG9kb3MpO1xuICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9kb3MnLCB0b2RvVG9Kc29uKTtcbn1cblxuLyoqXG4gKiBSZXRyaWV2ZXMgYSBKU09OIHN0cmluZyBmcm9tIGxvY2FsU3RvcmFnZVxuICogQHBhcmFtIGl0ZW1OYW1lIC0gVGhlIGtleSBpbiB0aGUga2V5OnZhbHVlIHBhaXIgb2YgbG9jYWxTdG9yYWdlXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBFaXRoZXIgYSBzdHJpbmcgb2YgdGhlIHVzZXJzIHRvZG9zIG9yIGFuIGVtcHR5IGFycmF5XG4gKi9cbmZ1bmN0aW9uIGdldEl0ZW1zRnJvbUxvY2FsU3RvcmFnZShpdGVtTmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgY29uc3Qgc3RvcmFnZSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKGl0ZW1OYW1lKTtcbiAgcmV0dXJuIHN0b3JhZ2UgIT09IG51bGwgPyBzdG9yYWdlIDogJ1tdJztcbn1cblxuLyoqXG4gKiBQYXJzZXMgdGhlIHVzZXJzIHRvZG8nc1xuICogQHBhcmFtIGl0ZW0gLSBQYXJzZXMgYSBzdHJpbmdcbiAqIEByZXR1cm5zIHtUb2RvW119IEFuIGFycmF5IG9mIG9iamVjdHMgb2YgdHlwZSBUb2RvXG4gKi9cbmZ1bmN0aW9uIHBhcnNlVG9kb3MoaXRlbTogc3RyaW5nKTogVG9kb1tdIHtcbiAgcmV0dXJuIEpTT04ucGFyc2UoaXRlbSk7XG59XG5cbi8qKlxuICogU2ltcGx5IGZvciB0YWtpbmcgb3V0IHRoZSBibG9hdCBmcm9tIHRoZSBzY3JpcHQgaXRzZWxmXG4gKiBAcmV0dXJucyBUaGUgZXhhbXBsZSBUb2RvXG4gKi9cbmZ1bmN0aW9uIHJlbmRlckxpc3RJdGVtTm9kZSh0ZW1wbGF0ZTogSFRNTFRlbXBsYXRlRWxlbWVudCk6IFRvZG8ge1xuICBjb25zdCBkb2NGcmFnbWVudDogRG9jdW1lbnRGcmFnbWVudCA9IHRlbXBsYXRlLmNvbnRlbnQ7XG4gIGNvbnN0IGxpc3RJdGVtQ2xvbmUgPSBkb2NGcmFnbWVudC5maXJzdEVsZW1lbnRDaGlsZD8uY2xvbmVOb2RlKFxuICAgIHRydWVcbiAgKSBhcyBIVE1MTElFbGVtZW50O1xuXG4gIGNvbnN0IGlkID0gbGlzdEl0ZW1DbG9uZS5kYXRhc2V0LmlkIGFzIHN0cmluZztcbiAgY29uc3QgcEVsID0gbGlzdEl0ZW1DbG9uZS5jaGlsZE5vZGVzWzNdO1xuICBjb25zdCB0ZXh0ID0gcEVsLnRleHRDb250ZW50Py50cmltKCkgYXMgc3RyaW5nO1xuXG4gIGNvbnN0IG5ld1RvZG86IFRvZG8gPSB7XG4gICAgaWQ6IGlkLFxuICAgIHZhbHVlOiB0ZXh0LFxuICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gIH07XG5cbiAgcmV0dXJuIG5ld1RvZG87XG59XG4iXX0="}